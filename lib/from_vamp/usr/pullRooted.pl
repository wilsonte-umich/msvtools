#!/usr/bin/perl
use strict;
use warnings;

use vars(qw(%param %types %fields %refSeqs %reverseRefSeqs));

#${EUSRC}/assembly/Assemble.pl Ty.fa 15
#${EUSRC}/assembly/Assemble.pl Flanking.fa 15
#${EUSRC}/assembly/Assemble.pl chr2Ty.fa 15

#sub pullRooted{
#    my $sample = "vac22wt";
#    my $root = "Ty";
#    my $directory = "$param{inputPath}/$sample\_$root";
#    open my $outputH_Ty, ">", "$directory/Ty.fa";
#    open my $outputH2_Flanking, ">", "$directory/Flanking.fa";
#    pullRootedN($outputH_Ty, $outputH2_Flanking, $sample, "Ty2L", 2);
#    pullRootedN($outputH_Ty, $outputH2_Flanking, $sample, "Ty2R", 1);
#    close $outputH_Ty;
#    close $outputH2_Flanking;
#}

#sub pullRootedN{
#    my ($outputH_Ty, $outputH2_Flanking, $sample, $root, $strand) = @_;
#    my $directory = "$param{inputPath}/$sample\_$root";
#    my $pairedReadsFile = "$directory/$sample\_$root\_$root\_pairedReads.csv";
#    runSQL("select pairid from frags_vac22wt_$root where strand1 = $strand group by pairid",\my($pairID));
#    while(fetchRow()){
#        $pairID =~ m/(.*).{8}$/;
#        $pairID = $1;
#        open my $inputFileH, "<", $pairedReadsFile;    
#        while(my $line = <$inputFileH>){
#            chomp $line;
#            my ($inputPairID, $flanking, $ty) = split(",", $line);#pairID,alignedSequence,partnerSequence 
#            if($inputPairID == $pairID){
#                print $outputH_Ty ">$pairID\n$ty\n";
#                print $outputH2_Flanking ">$pairID\n$flanking\n";
#                last;
#            }
#        }
#        close $inputFileH;    
#    }
#}

my %fpids;

sub pullRooted{
    my $sample = "vac22wt";
    getFPIDs($sample);
    my $root = 'Ty';
    my $directory = "$param{inputPath}/$sample\_$root";
    my $pairedReadsFile = "$directory/$sample\_$root\_$root\_pairedReads.csv";   
    open my $fileH, "<", $pairedReadsFile;
    open my $outputH, ">", "$directory/chr2Ty.fa";
    while (my $line = <$fileH>){
        my ($pairID, $tyRead) = split(",", $line);#pairID,alignedSequence,partnerSequence 
        $fpids{$pairID} or next;
        print $outputH ">$pairID\n$tyRead\n";
    }
    close $fileH;
    close $outputH;


#    open my $inH, "<", "/home/wilsonte/vamp/data/vac22wt_Ty/chr2Ty.fa.contig";
#    open my $outH, ">", "/home/wilsonte/vamp/data/vac22wt_Ty/chr2Ty.nt";
#    my ($id, $contig);
#    while (my $line = <$inH>){
#        if($line =~ m/^(>.*)/){
#            if($contig){
#                print $outH "$id\n$contig\n";
#                print $outH "$id\.rc\n".reverseComplement($contig)."\n";
#            }
#            $contig = undef;
#            $id = $1;
#        } elsif ($id){
#            chomp $line;
#            if($line){
#                $contig .= $line;
#            }
#        }  
#    }
#    close $inH;
#    close $outH;  
}

sub getFPIDs{
    my ($sample) = @_;
    foreach my $root('Ty2L','Ty2R'){
        my $directory = "$param{inputPath}/$sample\_$root";
        my $pairedReadsFile = "$directory/$sample\_$root\_$root\_pairedReads.csv";     
        open my $fileH, "<", $pairedReadsFile;
        while (my $line = <$fileH>){
            my ($pairID) = split(",", $line);#pairID,alignedSequence,partnerSequence 
            $fpids{$pairID}++;
        }
        close $fileH;
    }
}



#my $ty1 = 
#"TGTTGGAATAAAAATCCACTATCGTCTATCAACTAATAGTTATATTATCAATATATTATC
#ATATACGGTGTTAAGATGATGACATAAGTTATGAGAAGCTGTCATCGAGGTTAGAGGAAG
#CTGAAGTGCAAGGATTGATAATGTAATAGGATAATGAAACATATAAAACGGAATGAGGAA
#TAATCGTAATATTAGTATGTAGAAATATAGATTCCATTTTGAGGATTCCTATATCCTCGA
#GGAGAACTTCTAGTATATTCTGTATATCTAATATTATAGCCTTTATCAACAATGGAATCC
#CAACAATTATCTAATTACCCACATATATCTCATGGTAGCGCCTGTGCTTCGGTTACTTCT
#AAGGAAGTCCACACAAATCAAGATCCGTTAGACGTTTCAGCTTCCAAAATTCAAGAATAT
#GATAAGGCTTCCACTAAGGCTAACTCTCAACAGACAACAACACCTGCTTCATCAGCTGTT
#CCAGAGAACCTCCATCATGCCTCTCCTCAACCTGCTTCAGTACCACCTCCACAGAATGGG
#CCGTACCCACAGCAGTGCATGATGACCCAAAACCAAGCCAATCCATCTGGTTGGTCATTT
#TACGGACACCCATCTATGATTCCGTATACACCTTATCAAATGTCGCCTATGTACTTTCCA
#CCTGGGCCACAATCACAGTTTCCGCAGTATCCATCATCAGTTGGAACGCCTCTGAGCACT
#CCATCACCTGAGTCAGGTAATACATTTACTGATTCATCCTCAGCGGACTCTGATATGACA
#TCCACTAAAAAATATGTCAGACCACCACCAATGTTAACCTCACCTAATGACTTTCCAAAT
#TGGGTTAAAACATACATCAAATTTTTACAAAACTCGAATCTCGGTGGTATTATTCCGACA
#GTAAACGGAAAACCCGTACCACCAATGTTAACCTCACCTAATGACTTTCCAAATTGGGTT
#AAAACATACATCAAATTTTTACAAAACTCGAATCTCGGTGGTATTATTCCGACAGTAAAC
#GGAAAACCCGTACGTCAGATCACTGATGATGAACTCACCTTCTTGTATAACACTTTTCAA
#ATATTTGCTCCCTCTCAATTCCTACCTACCTGGGTCAAAGACATCCTATCCGTTGATTAT
#ACGGATATCATGAAAATTCTTTCCAAAAGTATTGAAAAAATGCAATCTGATACCCAAGAG
#GCAAACGACATTGTGACCCTGGCAAATTTGCAATATAATGGCAGTACACCTGCAGATGCA
#TTTGAAACAAAAGTCACAAACATTATCGACAGACTGAACAATAATGGCATTCATATCAAT
#AACAAGGTCGCATGCCAATTAATTATGAGAGGTCTATCTGGCGAATATAAATTTTTACGC
#TACACACGTCATCGACATCTAAATATGACAGTCGCTGAACTGTTCTTAGATATCCATGCT
#ATTTATGAAGAACAACAGGGATCGAGAAACAGCAAACCTAATTACAGGAGAAATCCGAGT
#GATGAGAAGAATGATTCTCGCAGCTATACGAATACAACCAAACCCAAAGTTATAGCTCGG
#AATCCTCAAAAAACAAATAATTCGAAATCGAAAACAGCCAGGGCTCACAATGTATCCACA
#TCTAATAACTCTCCCAGCACGGACAACGATTCCATCAGTAAATCAACTACTGAACCGATT
#CAATTGAACAATAAGCACGACCTTCATCTTAGGCCAGAAACTTACTGAATCTACAGTAAA
#TCATACTAATCATTCTGATGATGAACTCCCTGGACACCTCCTTCTCGATTCAGGAGCATC
#ACGAACCCTTATAAGATCTGCTCATCACATACACTCAGCATCATCTAATCCTGACATAAA
#CGTAGTTGATGCTCAAAAAAGAAATATACCAATTAACGCTATTGGTGACCTACAATTTCA
#CTTCCAGGACAACACCAAAACATCAATAAAGGTATTGCACACTCCTAACATAGCCTATGA
#CTTACTCAGTTTGAATGAATTGGCTGCAGTAGATATCACAGCATGCTTTACCAAAAACGT
#CTTAGAACGGTCTGACGGCACTGTACTTGCACCTATCGTAAAATATGGAGACTTTTACTG
#GGTATCTAAAAAGTACTTGCTTCCATCAAATATCTCCGTACCCACCATCAATAATGTCCA
#TACAAGTGAAAGTACACGCAAATATCCTTATCCTTTCATTCATCGAATGCTTGCGCATGC
#CAATGCACAGACAATTCGATACTCACTTAAAAATAACACCATCACGTATTTTAACGAATC
#AGATGTCGACTGGTCTAGTGCTATTGACTATCAATGTCCTGATTGTTTAATCGGCAAAAG
#CACCAAACACAGACATATCAAAGGTTCACGACTAAAATACCAAAATTCATACGAACCCTT
#TCAATACCTACATACTGACATATTTGGTCCAGTTCACAACCTACCAAAAAGTGCACCATC
#CTATTTCATCTCATTTACTGATGAGACAACAAAATTCCGTTGGGTTTATCCATTACACGA
#CCGTCGCGAGGACTCTATCCTCGATGTTTTTACTACGATACTAGCTTTTATTAAAAACCA
#GTTTCAGGCCAGTGTCTTGGTTATACAAATGGACCGTGGTTCTGAGTATACTAACAGAAC
#TCTCCATAAATTCCTTGAAAAAAATGGTATAACTCCATGCTATACAACCACAGCGGATTC
#CCGAGCACATGGAGTCGCTGAACGGCTCAACCGTACCTTATTAGATGACTGCCGTACTCA
#ACTGCAATGTAGTGGTTTACCGAACCATTTATGGTTCTCTGCAATCGAATTTTCTACTAT
#TGTGAGAAATTCACTAGCTTCACCTAAAAGCAAAAAATCTGCAAGACAACATGCTGGCTT
#GGCAGGACTTGATATCAGTACTTTGTTACCTTTCGGTCAACCTGTTATCGTCAATGATCA
#CAACCCTAACTCCAAAATACATCCTCGTGGCATCCCAGGCTACGCTCTACATCCGTCTCG
#AAACTCTTATGGATATATCATCTATCTTCCGTCCTTAAAGAAGACAGTAGATACAACTAA
#CTATGTTATTCTTCAGGGCAAGGAATCCAGATTAGATCAATTCAATTACGACGCACTCAC
#TTTCGATGAAGACTTAAACCGTTTAACTGCTTCATATCATTCGTTCATTGCGTCAAATGA
#GATCCAACAATCCAATGATCTTAACATAGAATCTGACCATGACTTCCAATCTGACATTGA
#ACTACATCCTGAGCAACTGAGAAATGTCCTTTCAAAAGCTGTGAGTCCAACCGATTCCAC
#ACCTCCGTCAACTCATACTGAAGATTCGAAACGTGTTTCCAAAACCAATATTCGCGCACC
#CAGAGAAGTTGACCCCAACATATCTGAATCTAATATTCTTCCATCTAAGAAGAGATCTAG
#CACCCCCCAAATTTCCGATATCGAGAGTACCGGTTCGGGTGGTATGCATAGATTAGATGT
#TCCTTTACTTGCTCCCATGTCCCAATCTAACACACATGAGTCGTCGCACGCCAGTAAATC
#TAAAGATTTCAGACACTCAGACTCGTACAGTGACAATGAGACTAATCATACAAACGTACC
#AATATCCAGTACGGGTGGTACCAATAATAAAACTGTTCCGCAGACAAGCGAACAGGAGAC
#TGAGAAAAGGATCATACACCGTTCACCTTCGATCGATACTTCCTCATCAGAAAGTAATTC
#ACTACACCACGTCGTTCCTATCAAAACGTCAGATACCTGTCCTAAGGAGAATACAGAGGA
#ATCTATTATCGCTGATCTTCCACTCCCCGATCTGCCTCCAGAACCTCCTACCGAATTATC
#AGACTCCTTTAAAGAACTCCCACCGATAAATTCTCATCAAACTAATTCCAGTTTGGGTGG
#TATTGGTGACTCTAATGCCTATACTACTATCAACAGTAAGAAAAGATCATTAGAAGATAA
#TGAAACTGAAATTAAGGTATCACGAGACACATGGAATACTAAGAATATGCGTAGTTTAGA
#ACCTCCGAGATCGAAGAAACGAATTCACCTGATTGCAGCTGTAAAAGCAGTAAAATCAAT
#CAAACCAATACGAACAACCTTACGATACGATGAGGCAATCACCTATAATAAAGATATTAA
#AGAAAAAGAAAAATATATCCAGGCATACCACAAAGAAGTCAATCAACTGTTGATGATGAA
#AACTTGGGACACTGACAGATATTATGACAGAAAAGAAATAGACCCCAAAAGAGTAATAAA
#TTCAATGTTTATCTTTAACAGGAAACGTGACGGTACTCATAAAGCTAGATTTGTTGCAAG
#AGGTGATATTCAACATCCTGACACTTACGACCCAGGCATGCAATCCAATACCGTACATCA
#CTATGCATTAATGACATCCCTGTCACTTGCATTAGACAATAACTACTATATTACACAATT
#AGACATATCTTCGGCATATTTGTATGCAGACATCAAAGAAGAACTATACATAAGACCTCC
#ACCACATTTAGGAATGAATGATAAGTTGATACGTTTGAAGAAATCACTTTATGGATTGAA
#ACAAAGTGGAGCGAACTGGTACGAAACTATCAAATCATACCTGATAAAACAGTGTGGTAT
#GGAAGAAGTTCGTGGATGGTCATGCGTATTTAAGAATAGTCAAGTAACAATTTGCTTATT
#CGTTGATGATATGATATTGTTCAGCAAAGACTTAAATGCAAATAAGAAAATCATAACAAC
#ACTCAAGAAACAATACGATACAAAGATAATAAATCTGGGTGAAAGTGATAACGAAATTCA
#GTACGACATACTTGGCTTAGAAATCAAATATCAAAGAGGTAAATACATGAAATTAGGTAT
#GGAAAACTCATTAACTGAGAAAATACCCAAATTAAACGTACCTTTGAATCCAAAAGGAAG
#AAAACTTAGCGCTCCAGGTCAACCAGGTCTTTATATAGACCAGGATGAACTAGAAATAGA
#TGAAGATGAATACAAAGAGAAGGTACATGAAATGCAAAAGTTGATTGGTCTAGCTTCATA
#TGTTGGATATAAATTTAGATTTGACTTACTATACTACATCAACACACTTGCTCAACATAT
#ACTATTCCCCTCTAGGCAAGTTTTAGACATGACATATGAGTTAATACAATTCATGTGGGA
#CACTAGAGATAAACAACTGATATGGCACAAAAACAAACCTACCGAGCCAGATAATAAACT
#AGTCGCAATAAGTGATGCTTCATATGGTAACCAACCATATTACAAGTCACAAATTGGCAA
#CATATATTTACTTAATGGAAAGGTAATTGGAGGAAAGTCCACCAAGGCTTCATTAACATG
#TACTTCAACTACGGAAGCAGAAATACACGCGATAAGTGAATCTGTCCCATTATTAAATAA
#CCTCAGTCACCTTGTGCAAGAACTTAACAAGAAACCAATTACTAAAGGATTACTAACCGA
#CAGTAAATCTACAATCAGTATAATTATATCCAATAATGAAGAGAAATTTAGAAACAGATT
#TTTTGGTACTAAAGCAATGAGACTAAGAGATGAAGTATCAGGAAATCATCTGCACGTATG
#CTATATCGAAACCAAAAAGAATATTGCAGACGTAATGACCAAACCTCTTCCGATAAAAAC
#ATTCAAACTATTAACAAACAAATGGATTCATTAGATCTATTACATTATGGGTGGTATGTT
#GGAATAAAAATCCACTATCGTCTATCAACTAATAGTTATATTATCAATATATTATCATAT
#ACGGTGTTAAGATGATGACATAAGTTATGAGAAGCTGTCATCGAGGTTAGAGGAAGCTGA
#AGTGCAAGGATTGATAATGTAATAGGATAATGAAACATATAAAACGGAATGAGGAATAAT
#CGTAATATTAGTATGTAGAAATATAGATTCCATTTTGAGGATTCCTATATCCTCGAGGAG
#AACTTCTAGTATATTCTGTATACCTAATATTATAGCCTTTATCAACAATGGAATCCCAAC
#AATTATCTAATTACCCACATATATCTCA";

#my $ty1 = 
#"TCATGGTAGCGCCTGTGCTTCGGTTACTTCTAAGGAAGTCCACACAAATCAAGATCCGTTAGACGTTTCAGCTTCCAAAACAGAAGAATGTGAGAAGGCT
#TCCACTAAGGCTAACTCTCAACAGACAACAACACCTGCTTCATCAGCTGTTCCAGAGAACCCCCATCATGCCTCTCCTCAACCTGCTTCAGTACCACCTC
#CACAGAATGGGCCGTACCCACAGCAGTGCATGATGACCCAAAACCAAGCCAATCCATCTGGTTGGTCATTTTACGGACACCCATCTATGATTCCGTATAC
#ACCTTATCAAATGTCGCCTATGTACTTTCCACCTGGGCCACAATCACAGTTTCCGCAGTATCCATCATCAGTTGGAACGCCTCTGAGCACTCCATCACCT
#GAGTCAGGTAATACATTTACTGATTCATCCTCAGCGGACTCTGATATGACATCCACTAAAAAATATGTCAGACCACCACCAATGTTAACCTCACCTAATG
#ACTTTCCAAATTGGGTTAAAACATACATCAAATTTTTACAAAACTCGAATCTCGGTGGTATTATTCCGACAGTAAACGGAAAACCCGTACCACCAATGTT
#AACCTCACCTAATGACTTTCCAAATTGGGTTAAAACATACATCAAATTTTTACAAAACTCGAATCTCGGTGGTATTATTCCGACAGTAAACGGAAAACCC
#GTACGTCAGATCACTGATGATGAACTCACCTTCTTGTATAACACTTTTCAAATATTTGCTCCCTCTCAATTCCTACCTACCTGGGTCAAAGACATCCTAT
#CCGTTGATTATACGGATATCATGAAAATTCTTTCCAAAAGTATTGAAAAAATGCAATCTGATACCCAAGAGGCAAACGACATTGTGACCCTGGCAAATTT
#GCAATATAATGGCAGTACACCTGCAGATGCATTTGAAACAAAAGTCACAAACATTATCGACAGACTGAACAATAATGGCATTCATATCAATAACAAGGTC
#GCATGCCAATTAATTATGAGAGGTCTATCTGGCGAATATAAATTTTTACGCTACACACGTCATCGACATCTAAATATGACAGTCGCTGAACTGTTCTTAG
#ATATCCATGCTATTTATGAAGAACAACAGGGATCGAGAAACAGTAAACCTAATTACAGGAGAAATCCGAGTGATGAGAAGAATGATTCTCGCAGCTATAC
#GAATACAACCAAACCCAAAGTTATAGCTCGGAATCCTCAAAAAACAAATAATTCGAAATCGAAAACAGCCAGGGCTCACAATGTATCCACATCTAATAAC
#TCTCCCAGCACGGACAACGATTCCATCAGTAAATCAACTACTGAACCGATTCAATTGAACAATAAGCACGACCTTCATCTTAGGCCAGAAACTTACTGAA
#TCTACAGTAAATCATACTAATCATTCTGATGATGAACTCCCTGGACACCTCCTTCTCGATTCAGGAGCATCACGAACCCTTATAAGATCTGCTCATCACA
#TACACTCAGCATCATCTAATCCTGACATAAACGTAGTTGATGCTCAAAAAAGAAATATACCAATTAACGCTATTGGTGACCTACAATTTCACTTCCAGGA
#CAACACCAAAACATCAATAAAGGTATTGCACACTCCTAACATAGCCTATGACTTACTCAGTTTGAATGAATTGGCTGCAGTAGATATCACAGCATGCTTT
#ACCAAAAACGTCTTAGAACGGTCTGACGGCACTGTACTTGCACCTATCGTAAAATATGGAGACTTTTACTGGGTATCTAAAAAGTACTTGCTTCCATCAA
#ATATCTCCGTACCCACCATCAATAATGTCCATACAAGTGAAAGTACACGCAAATATCCTTATCCTTTCATTCATCGAATGCTTGCGCATGCCAATGCACA
#GACAATTCGATACTCACTTAAAAATAACACCATCACGTATTTTAACGAATCAGATGTCGACTGGTCTAGTGCTATTGACTATCAATGTCCTGATTGTTTA
#ATCGGCAAAAGCACCAAACACAGACATATCAAAGGTTCACGACTAAAATACCAAAATTCATACGAACCCTTTCAATACCTACATACTGACATATTTGGTC
#CAGTTCACAACCTACCAAAAAGTGCACCATCCTATTTCATCTCATTTACTGATGAGACAACAAAATTCCGTTGGGTTTATCCATTACACGACCGTCGCGA
#GGACTCTATCCTCGATGTTTTTACTACGATACTAGCTTTTATTAAGAACCAGTTTCAGGCCAGTGTCTTGGTTATACAAATGGACCGTGGTTCTGAGTAT
#ACTAACAGAACTCTCCATAAATTCCTTGAAAAAAATGGTATAACTCCATGCTATACAACCACAGCGGATTCCCGAGCACATGGAGTCGCTGAACGGCTCA
#ACCGTACCTTATTAGATGACTGCCGTACTCAACTGCAATGTAGTGGTTTACCGAACCATTTATGGTTCTCTGCAATCGAATTTTCTACTATTGTGAGAAA
#TTCACTAGCTTCACCTAAAAGCAAAAAATCTGCAAGACAACATGCTGGCTTGGCAGGACTTGATATCAGTACTTTGTTACCTTTCGGTCAACCTGTTATC
#GTCAATGATCACAACCCTAACTCCAAAATACATCCTCGTGGCATCCCAGGCTACGCTCTACATCCGTCTCGAAACTCTTATGGATATATCATCTATCTTC
#CATCCTTAAAGAAGACAGTAGATACAACTAACTATGTTATTCTTCAGGGCAAGGAATCCAGATTAGATCAATTCAANTACGACGCACTCACTTTCGATGA
#AGACTTAAACCGTTTAACTGCTTCATATCAATCGNTCATTGCGTCAAATGAGATCCAACAATCCGATGATCTTAACATAGAATCTGACCATGACTTCCAA
#TCTGACATCGAACTACATCCTGAGCAACCGAGAAATGTCCTTTCAAAAGCTGTGAGTCCAACCGATTCCACACCTCCGTCAACTCATACTGAAGATTCGA
#AACGTGTTTCTAAAACCAATATTCGCGCACCCAGAGAAGTTGACCCCAACATATCTGAATCTAATATTCTTCCATCAAAGAAGAGATCTAGCACCCCCCA
#AATTTCCAATATCGAGAGTACCGGTTCGGGTGGTATGCATAAATTAAATGTTCCTTTACTTGCTCCCATGTCCCAATCTAACACACATGAGTCGTCGCAC
#GCCAGTAAATCTAAAGATTTCAGACACTCAGACTCGTACAGTGAAAATGAGACTAATCATACAAACGTACCAATATCCAGTACGGGTGGTACCAACAACA
#AAACTGTTCCGCAGATAAGTGACCAAGAGACTGAGAAAAGGATTATACACCGTTCACCTTCAATCGATGCTTCTCCATCAGAAAGTAATTCACTACACCA
#CGTCGTTCCTATCAAAACGTCAGATACCTGTCCTAAAGAGAATACCGAGGAATCTATCATCGCTGATCTCCCACTCCCTGATCTACCTCCAGAACCTCCT
#ACCGAATTCCCTGACCCATTTAAAGAACTCCCACCGATCAATTCTCGTCAAACTAATTCCAGTTTGGGTGGTATTGGTGACTCTAATGCCTATACTACTA
#TCAACAGTAAGAAAAGATCATTAGAAGATAATGAAACTGAAATTAAGGTATCACGAGACACATGGAATACTAAGAATATGCGTAGTTTAGAACCTCCGAG
#ATCGAAGAAACGAATTCACCTGATTGCAGCTGTAAAAGCAGTAAAATCAATCAAACCAATACGGACAACCTTACGATACGATGAGGCAATCACCTATAAT
#AAAGATATTAAAGAAAAAGAAAAATATATCGAGGCATACCACAAAGAAGTCAATCAACTGTTGAAGATGAAAACTTGGGACACTGACGAATATTATGACA
#GAAAAGAAATAGACCCTAAAAGAGTAATAAACTCAATGTTTATCTTCAACAAGAAACGTGACGGTACTCATAAAGCTAGATTTGTTGCAAGAGGTGATAT
#TCAGCATCCTGACACTTACGACTCAGGCATGCAATCCAATACCGTACATCACTATGCATTAATGACATCCCTGTCACTTGCATTAGACAATAACTACTAT
#ATTACACAATTAGACATATCTTCGGCATATTTGTATGCAGACATCAAAGAAGAATTATACATAAGACCTCCACCACATTTAGGAATGAATGATAAGTTGA
#TACGTTTGAAGAAATCACTTTATGGATTGAAACAAAGTGGAGCGAACTGGTACGAAACTATCAAATCATACCTGATACAACAATGTGGTATGGAAGAAGT
#TCGTGGATGGTCATGCGTATTTAAAAACAGTCAAGTGACAATTTGTTTATTCGTAGATGATATGGTATTGTTTAGCAAAGACTTAAATGCAAATAAGAAA
#ATCATAACAACACTCAAGAAACAATACGATACAAAGATAATAAATCTGGGTGAAAGTGATAACGAAATTCAGTACGACATTCTTGGCTTGGAAATCAAAT
#ACCAAAGAGGTAAATACATGAAATTGGGTATGGAAAACTCATTAACTGAAAAAATACCCAAACTAAACGTACCTTTAAACCCAAAAGGAAGGAAACTTAG
#TGCTCCAGGTCAACCAGGTCTATATATAGACCAGCAAGAACTAGAGCTAGATGAAGATGAATACAAAGAGAAGGTACATGAAATGCAAAAGCTGATAGGT
#CTAGCATCATATGTTGGATATAAATTTAGATTTGACCTATTATACTACATCAACACACTTGCACAACATATACTATTTCCGTCCAAGCAAGTTTTAGACA
#TGACATATGAGTTAATACAATTCATGTGGGACACTAGAGATAAACAACTGATATGGCACAAAAACAAACCTACCGAGCCAGATAATAAACTAGTCGCAAT
#AAGTGATGCTTCATATGGCAACCAACCGTATTATAAATCACAAATTGGCAACATATATTTACTTAATGGAAAGGTAATTGGAGGAAAGTCCACCAAGGCT
#TCATTAACATGTACTTCAACTACGGAAGCAGAAATACACGCGATAAGTGAATCTGTCCCATTATTAAATAACCTCAGTCACCTGGTGCAAGAACTTGACA
#AGAAACCAATTACCAAAGGATTACTAACCGACAGTAAATCTACAATCAGTATAATTATATCCAATAATGAAGAGAAATTTAGGAACAGATTTTTTGGTAC
#TAAAGCAATGAGATTGAGAGATGAAGTATCAGGAAATCATCTGCACGTATGCTATATCGAAACCAAAAAGAATATTGCAGACGTAATGACCAAACCTCTT
#CCGATAAAAACATTCAAACTATTAACAAACAAATGGATTCATTAGATCTATTACATTATGGGTGGTATGTTGGAATAAAAATCCACTATCGTCTATCAAC
#TAATAGTTATATTATCAATATATTATCATATACGGTGTTAAGATGATGACATAAGTTATGAGAAGCTGTCATCGAGGTTAGAGGAAGCTGAAGTGCAAGG
#ATTGATAATGTAATAGGATAATGAAACATATAAAACGGAATGAGGAATAATCGTAATATTAGTATGTAGAAATATAGATTCCATTTTGAGGATTCCTATA
#TCCTCGAGGAGAACTTCTAGTATATTCTGTATACCTAATATTATAGCCTTTATCAACAATGGAATC
#";

#my $ty1 = "
#TCATGGTAGCGCCTGTGCTTCGGTTACTTCTAAGGAAGTCCACACAAATCAAGATCCGTTAGACGTTTCAGCTTCCAAAACAGAAGAATGTGAGAAGGCT
#TCCACTAAGGCTAACTCTCAACAGACAACAACACCTGCTTCATCAGCTGTTCCAGAGAACCCCCATCATGCCTCTCCTCAACCTGCTTCAGTACCACCTC
#CACAGAATGGGCCGTACCCACAGCAGTGCATGATGACCCAAAACCAAGCCAATCCATCTGGTTGGTCATTTTACGGACACCCATCTATGATTCCGTATAC
#ACCTTATCAAATGTCGCCTATGTACTTTCCACCTGGGCCACAATCACAGTTTCCGCAGTATCCATCATCAGTTGGAACGCCTCTGAGCACTCCATCACCT
#GAGTCAGGTAATACATTTACTGATTCATCCTCAGCGGACTCTGATATGACATCCACTAAAAAATATGTCAGACCACCACCAATGTTAACCTCACCTAATG
#ACTTTCCAAATTGGGTTAAAACATACATCAAATTTTTACAAAACTCGAATCTCGGTGGTATTATTCCGACAGTAAACGGAAAACCCGTACCACCAATGTT
#AACCTCACCTAATGACTTTCCAAATTGGGTTAAAACATACATCAAATTTTTACAAAACTCGAATCTCGGTGGTATTATTCCGACAGTAAACGGAAAACCC
#GTACGTCAGATCACTGATGATGAACTCACCTTCTTGTATAACACTTTTCAAATATTTGCTCCCTCTCAATTCCTACCTACCTGGGTCAAAGACATCCTAT
#CCGTTGATTATACGGATATCATGAAAATTCTTTCCAAAAGTATTGAAAAAATGCAATCTGATACCCAAGAGGCAAACGACATTGTGACCCTGGCAAATTT
#GCAATATAATGGCAGTACACCTGCAGATGCATTTGAAACAAAAGTCACAAACATTATCGACAGACTGAACAATAATGGCATTCATATCAATAACAAGGTC
#GCATGCCAATTAATTATGAGAGGTCTATCTGGCGAATATAAATTTTTACGCTACACACGTCATCGACATCTAAATATGACAGTCGCTGAACTGTTCTTAG
#ATATCCATGCTATTTATGAAGAACAACAGGGATCGAGAAACAGTAAACCTAATTACAGGAGAAATCCGAGTGATGAGAAGAATGATTCTCGCAGCTATAC
#GAATACAACCAAACCCAAAGTTATAGCTCGGAATCCTCAAAAAACAAATAATTCGAAATCGAAAACAGCCAGGGCTCACAATGTATCCACATCTAATAAC
#TCTCCCAGCACGGACAACGATTCCATCAGTAAATCAACTACTGAACCGATTCAATTGAACAATAAGCACGACCTTCATCTTAGGCCAGAAACTTACTGAA
#TCTACAGTAAATCATACTAATCATTCTGATGATGAACTCCCTGGACACCTCCTTCTCGATTCAGGAGCATCACGAACCCTTATAAGATCTGCTCATCACA
#TACACTCAGCATCATCTAATCCTGACATAAACGTAGTTGATGCTCAAAAAAGAAATATACCAATTAACGCTATTGGTGACCTACAATTTCACTTCCAGGA
#CAACACCAAAACATCAATAAAGGTATTGCACACTCCTAACATAGCCTATGACTTACTCAGTTTGAATGAATTGGCTGCAGTAGATATCACAGCATGCTTT
#ACCAAAAACGTCTTAGAACGGTCTGACGGCACTGTACTTGCACCTATCGTAAAATATGGAGACTTTTACTGGGTATCTAAAAAGTACTTGCTTCCATCAA
#ATATCTCCGTACCCACCATCAATAATGTCCATACAAGTGAAAGTACACGCAAATATCCTTATCCTTTCATTCATCGAATGCTTGCGCATGCCAATGCACA
#GACAATTCGATACTCACTTAAAAATAACACCATCACGTATTTTAACGAATCAGATGTCGACTGGTCTAGTGCTATTGACTATCAATGTCCTGATTGTTTA
#ATCGGCAAAAGCACCAAACACAGACATATCAAAGGTTCACGACTAAAATACCAAAATTCATACGAACCCTTTCAATACCTACATACTGACATATTTGGTC
#CAGTTCACAACCTACCAAAAAGTGCACCATCCTATTTCATCTCATTTACTGATGAGACAACAAAATTCCGTTGGGTTTATCCATTACACGACCGTCGCGA
#GGACTCTATCCTCGATGTTTTTACTACGATACTAGCTTTTATTAAGAACCAGTTTCAGGCCAGTGTCTTGGTTATACAAATGGACCGTGGTTCTGAGTAT
#ACTAACAGAACTCTCCATAAATTCCTTGAAAAAAATGGTATAACTCCATGCTATACAACCACAGCGGATTCCCGAGCACATGGAGTCGCTGAACGGCTCA
#ACCGTACCTTATTAGATGACTGCCGTACTCAACTGCAATGTAGTGGTTTACCGAACCATTTATGGTTCTCTGCAATCGAATTTTCTACTATTGTGAGAAA
#TTCACTAGCTTCACCTAAAAGCAAAAAATCTGCAAGACAACATGCTGGCTTGGCAGGACTTGATATCAGTACTTTGTTACCTTTCGGTCAACCTGTTATC
#GTCAATGATCACAACCCTAACTCCAAAATACATCCTCGTGGCATCCCAGGCTACGCTCTACATCCGTCTCGAAACTCTTATGGATATATCATCTATCTTC
#CATCCTTAAAGAAGACAGTAGATACAACTAACTATGTTATTCTTCAGGGCAAGGAATCCAGATTAGATCAATTCAATTACGACGCACTCACTTTCGATGA
#AGACTTAAACCGTTTAACTGCTTCATATCAATCGTTCATTGCGTCAAATGAGATCCAACAATCCGATGATCTTAACATAGAATCTGACCATGACTTCCAA
#TCTGACATCGAACTACATCCTGAGCAACCGAGAAATGTCCTTTCAAAAGCTGTGAGTCCAACCGATTCCACACCTCCGTCAACTCATACTGAAGATTCGA
#AACGTGTTTCTAAAACCAATATTCGCGCACCCAGAGAAGTTGACCCCAACATATCTGAATCTAATATTCTTCCATCAAAGAAGAGATCTAGCACCCCCCA
#AATTTCCAATATCGAGAGTACCGGTTCGGGTGGTATGCATAAATTAAATGTTCCTTTACTTGCTCCCATGTCCCAATCTAACACACATGAGTCGTCGCAC
#GCCAGTAAATCTAAAGATTTCAGACACTCAGACTCGTACAGTGAAAATGAGACTAATCATACAAACGTACCAATATCCAGTACGGGTGGTACCAACAACA
#AAACTGTTCCGCAGATAAGTGACCAAGAGACTGAGAAAAGGATTATACACCGTTCACCTTCAATCGATGCTTCTCCACCGGAAAATAATTCACTACACCA
#CGTCGTTCCTATCAAAACGTCAGATACCGGTTCTAAACAGAATACCGAGGAATCTATCATCGCTGATCTCCCACTCCCTGATCTACCTCCAGAATCTCCT
#ACCGAATTCCCTGACCCATTTAAAGAACTCCCACCGATCAATTCTCGTCAAACTAATTCCAGTTTGGGTGGTATTGGTGACTCTAATGCCTATACTACTA
#TCAACAGTAAGAAAAGATCATTAGAAGATAATGAAACTGAAATTAAGGTATCACGAGACACATGGAATACTAAGAATATGCGTAGTTTAGAACCTCCGAG
#ATCGAAGAAACGAATTCACCTGATTGCAGCTGTAAAAGCAGTAAAATCAATCAAACCAATACGGACAACCTTACGATACGATGAGGCAATCACCTATAAT
#AAAGATATTAAAGAAAAAGAAAAATATATCGAGGCATACCACAAAGAAGTCAATCAACTGTTGAAGATGAAAACTTGGGACACTGACGAATATTATGACA
#GAAAAGAAATAGACCCTAAAAGAGTAATAAACTCAATGTTTATCTTCAACAAGAAACGTGACGGTACTCATAAAGCTAGATTTGTTGCAAGAGGTGATAT
#TCAGCATCCTGACACTTACGACTCAGGCATGCAATCCAATACCGTACATCACTATGCATTAATGACATCCCTGTCACTTGCATTAGACAATAACTACTAT
#ATTACACAATTAGACATATCTTCGGCATATTTGTATGCAGACATCAAAGAAGAATTATACATAAGACCTCCACCACATTTAGGAATGAATGATAAGTTGA
#TACGTTTGAAGAAATCACTTTATGGATTGAAACAAAGTGGAGCGAACTGGTACGAAACTATCAAATCATACCTGATACAACAATGTGGTATGGAAGAAGT
#TCGTGGATGGTCATGCGTATTTAAAAACAGTCAAGTGACAATTTGTTTATTCGTAGATGATATGGTATTGTTTAGCAAAAATCTAAATGCAAATAAGAAA
#ATCATAACAACACTCAAGAAACAATACGATACAAAGATAATAAATCTGGGTGAAAGTGATAACGAAATTCAATACGACATTCTTGGCTTGGAAATCAAAT
#ACCAAAGAGGTAAATACATGAAATTGGGTATGGAAAACTCATTAACTGAAAAAATACCCAAACTAAACGTACCTTTAAACCCAAAAGGAAGGAAACTTAG
#TGCTCCAGGTCAACCAGGTCTATATATAGACCAGCAAGAACTAGAGCTAGAAGAAGATGATTACAAAATGAAGGTACATGAAATGCAAAAGCTGATAGGT
#CTAGCATCATATGTTGGATATAAATTTAGATTTGACCTATTATACTACATCAACACACTTGCACAACATATACTATTTCCGTCCAAGCAAGTGTTAGATA
#TGACATATGAATTGATACAATTCATGTGGGACACTAGAGATAAACAACTGATATGGCACAAAAACAAACCTACCGAGCCAGATAATAAACTAGTCGCAAT
#AAGCGATGCCTCGTATGGCAACCAACCGTATTATAAATCACAAATTGGCAACATATATTTACTTAATGGAAAGGTAATTGGAGGAAAGTCCACCAAGGCT
#TCATTAACATGTACTTCAACTACGGAAGCAGAAATACACGCGATAAGTGAATCTGTCCCATTATTAAATAATCTAAGTTACCTGATACAAGAACTTGACA
#AGAAACCAATTACCAAAGGATTACTAACCGACAGTAAATCTACAATCAGTATAATTATATCCAATAATGAAGAGAAATTTAGGAACAGATTTTTTGGTAC
#TAAAGCAATGAGATTGAGAGATGAAGTATCAGGAAATCATCTGCACGTATGCTATATCGAAACCAAAAAGAATATTGCAGACGTAATGACCAAACCTCTT
#CCGATAAAAACATTCAAACTATTAACAAACAAATGGATTCATTAGATCTATTACATTATGGGTGGTATGTTGGAATAAAAATCCACTATCGTCTATCAAC
#TAATAGTTATATTATCAATATATTATCATATACGGTGTTAAGATGATGACATAAGTTATGAGAAGCTGTCATCGAAGTTAGAGGAAGCTGAAACGCAAGG
#ATTGATAATGTAATAGGATCATGAAACATATAAAACGGAATGAGGAATAATCGTAATATTAGTATGTAGAAATATAGATTCCATTTTGAGGATTCCTATA
#TCCTCGAGGAGAACTTCTAGTATATTCTGTATACCTAATATTATAGCCTTTATCAACAATGGAATC
#";

#my $ty1 = "
#TCATGGTAGCGCCTGTGCTTCGGTTACTTCTAAGGAAGTCCACACAAATCAAGATCCGTTAGACGTTTCAGCTTCCAAAACAGAAGAATGTGAGAAGGCT
#TCCACTAAGGCTAACTCTCAACAGACAACAACACCTGCTTCATCAGCTGTTCCAGAGAACCCCCATCATGCCTCTCCTCAACCTGCTTCAGTACCACCTC
#CACAGAATGGGCCGTACCCACAGCAGTGCATGATGACCCAAAACCAAGCCAATCCATCTGGTTGGTCATTTTACGGACACCCATCTATGATTCCGTATAC
#ACCTTATCAAATGTCGCCTATGTACTTTCCACCTGGGCCACAATCACAGTTTCCGCAGTATCCATCATCAGTTGGAACGCCTCTGAGCACTCCATCACCT
#GAGTCAGGTAATACATTTACTGATTCATCCTCAGCGGACTCTGATATGACATCCACTAAAAAATATGTCAGACCACCACCAATGTTAACCTCACCTAATG
#ACTTTCCAAATTGGGTTAAAACATACATCAAATTTTTACAAAACTCGAATCTCGGTGGTATTATTCCGACAGTAAACGGAAAACCCGTACCACCAATGTT
#AACCTCACCTAATGACTTTCCAAATTGGGTTAAAACATACATCAAATTTTTACAAAACTCGAATCTCGGTGGTATTATTCCGACAGTAAACGGAAAACCC
#GTACGTCAGATCACTGATGATGAACTCACCTTCTTGTATAACACTTTTCAAATATTTGCTCCCTCTCAATTCCTACCTACCTGGGTCAAAGACATCCTAT
#CCGTTGATTATACGGATATCATGAAAATTCTTTCCAAAAGTATTGAAAAAATGCAATCTGATACCCAAGAGGCAAACGACATTGTGACCCTGGCAAATTT
#GCAATATAATGGCAGTACACCTGCAGATGCATTTGAAACAAAAGTCACAAACATTATCGACAGACTGAACAATAATGGCATTCATATCAATAACAAGGTC
#GCATGCCAATTAATTATGAGAGGTCTATCTGGCGAATATAAATTTTTACGCTACACACGTCATCGACATCTAAATATGACAGTCGCTGAACTGTTCTTAG
#ATATCCATGCTATTTATGAAGAACAACAGGGATCGAGAAACAGTAAACCTAATTACAGGAGAAATCCGAGTGATGAGAAGAATGATTCTCGCAGCTATAC
#GAATACAACCAAACCCAAAGTTATAGCTCGGAATCCTCAAAAAACAAATAATTCGAAATCGAAAACAGCCAGGGCTCACAATGTATCCACATCTAATAAC
#TCTCCCAGCACGGACAACGATTCCATCAGTAAATCAACTACTGAACCGATTCAATTGAACAATAAGCACGACCTTCATCTTAGGCCAGAAACTTACTGAA
#TCTACAGTAAATCATACTAATCATTCTGATGATGAACTCCCTGGACACCTCCTTCTCGATTCAGGAGCATCACGAACCCTTATAAGATCTGCTCATCACA
#TACACTCAGCATCATCTAATCCTGACATAAACGTAGTTGATGCTCAAAAAAGAAATATACCAATTAACGCTATTGGTGACCTACAATTTCACTTCCAGGA
#CAACACCAAAACATCAATAAAGGTATTGCACACTCCTAACATAGCCTATGACTTACTCAGTTTGAATGAATTGGCTGCAGTAGATATCACAGCATGCTTT
#ACCAAAAACGTCTTAGAACGGTCTGACGGCACTGTACTTGCACCTATCGTAAAATATGGAGACTTTTACTGGGTATCTAAAAAGTACTTGCTTCCATCAA
#ATATCTCCGTACCCACCATCAATAATGTCCATACAAGTGAAAGTACACGCAAATATCCTTATCCTTTCATTCATCGAATGCTTGCGCATGCCAATGCACA
#GACAATTCGATACTCACTTAAAAATAACACCATCACGTATTTTAACGAATCAGATGTCGACTGGTCTAGTGCTATTGACTATCAATGTCCTGATTGTTTA
#ATCGGCAAAAGCACCAAACACAGACATATCAAAGGTTCACGACTAAAATACCAAAATTCATACGAACCCTTTCAATACCTACATACTGACATATTTGGTC
#CAGTTCACAACCTACCAAAAAGTGCACCATCCTATTTCATCTCATTTACTGATGAGACAACAAAATTCCGTTGGGTTTATCCATTACACGACCGTCGCGA
#GGACTCTATCCTCGATGTTTTTACTACGATACTAGCTTTTATTAAGAACCAGTTTCAGGCCAGTGTCTTGGTTATACAAATGGACCGTGGTTCTGAGTAT
#ACTAACAGAACTCTCCATAAATTCCTTGAAAAAAATGGTATAACTCCATGCTATACAACCACAGCGGATTCCCGAGCACATGGAGTCGCTGAACGGCTCA
#ACCGTACCTTATTAGATGACTGCCGTACTCAACTGCAATGTAGTGGTTTACCGAACCATTTATGGTTCTCTGCAATCGAATTTTCTACTATTGTGAGAAA
#TTCACTAGCTTCACCTAAAAGCAAAAAATCTGCAAGACAACATGCTGGCTTGGCAGGACTTGATATCAGTACTTTGTTACCTTTCGGTCAACCTGTTATC
#GTCAATGATCACAACCCTAACTCCAAAATACATCCTCGTGGCATCCCAGGCTACGCTCTACATCCGTCTCGAAACTCTTATGGATATATCATCTATCTTC
#CATCCTTAAAGAAGACAGTAGATACAACTAACTATGTTATTCTTCAGGGCAAGGAATCCAGATTAGATCAATTCAANTACGACGCACTCACTTTCGATGA
#AGACTTAAACCGTTTAACTGCTTCATATCAATCGNTCATTGCGTCAAATGAGATCCAACAATCCGATGATCTTAACATAGAATCTGACCATGACTTCCAA
#TCTGACATCGAACTACATCCTGAGCAACCGAGAAATGTCCTTTCAAAAGCTGTGAGTCCAACCGATTCCACACCTCCGTCAACTCATACTGAAGATTCGA
#AACGTGTTTCTAAAACCAATATTCGCGCACCCAGAGAAGTTGACCCCAACATATCTGAATCTAATATTCTTCCATCAAAGAAGAGATCTAGCACCCCCCA
#AATTTCCAATATCGAGAGTACCGGTTCGGGTGGTATGCATAAATTAAATGTTCCTTTACTTGCTCCCATGTCCCAATCTAACACACATGAGTCGTCGCAC
#GCCAGTAAATCTAAAGATTTCAGACACTCAGACTCGTACAGTGAAAATGAGACTAATCATACAAACGTACCAATATCCAGTACGGGTGGTACCAACAACA
#AAACTGTTCCGCAGATAAGTGACCAAGAGACTGAGAAAAGGATTATACACCGTTCACCTTCAATCGATGCTTCTCCACCGGAAAATAATTCATCGCACCA
#CGTCGTTCCTATCAAAACGTCAGATACTGGTTCTGAACAGAATACCGAGGAATCTATCATCGCTGATCTCCCACTCCCTGATCTACCTCCAGAATCTCCT
#ACCGAATTCCCTGACCCATTTAAAGAACTCCCACCGATCAATTCTCGTCAAACTAATTCCAGTTTGGGTGGTATTGGTGACTCTAATGCCTATACTACTA
#TCAACAGTAAGAAAAGATCATTAGAAGATAATGAAACTGAAATTAAGGTATCACGAGACACATGGAATACTAAGAATATGCGTAGTTTAGAACCTCCGAG
#ATCGAAGAAACGAATTCACCTGATTGCAGCTGTAAAAGCAGTAAAATCAATCAAACCAATACGGACAACCTTACGATACGATGAGGCAATCACCTATAAT
#AAAGATATTAAAGAAAAAGAAAAATATATCGAGGCATACCACAAAGAAGTCAATCAACTGTTGAAGATGAAAACTTGGGACACTGACGAATATTATGACA
#GAAAAGAAATAGACCCTAAAAGAGTAATAAACTCAATGTTTATCTTCAACAAGAAACGTGACGGTACTCATAAAGCTAGATTTGTTGCAAGAGGTGATAT
#TCAGCATCCTGACACTTACGACTCAGGCATGCAATCCAATACCGTACATCACTATGCATTAATGACATCCCTGTCACTTGCATTAGACAATAACTACTAT
#ATTACACAATTAGACATATCTTCGGCATATTTGTATGCAGACATCAAAGAAGAATTATACATAAGACCTCCACCACATTTAGGAATGAATGATAAGTTGA
#TACGTTTGAAGAAATCACTTTATGGATTGAAACAAAGTGGAGCGAACTGGTACGAAACTATCAAATCATACCTGATACAACAATGTGGTATGGAAGAAGT
#TCGTGGATGGTCATGCGTATTTAAAAACAGTCAAGTGACAATTTGTTTATTCGTAGATGATATGGTATTGTTTAGCAAAAATCTAAATTCAAACAAAAGA
#ATCATAACAACACTCAAGAAACAATACGATACAAAGATAATAAATCTGGGTGAAAGTGATAACGAAATTCAATATGACATTCTTGGCTTGGAAATCAAAT
#ACCAAAGAGGTAAATACATGAAATTGGGTATGGAAAACTCATTAACTGAAAAAATACCCAAACTAAACGTACCTTTAAACCCAAAAGGAAGGAAACTTAG
#TGCTCCAGGTCAACCAGGTCTATATATAGACCAGCAAGAACTAGAGCTAGAAGAAGATGATTACAAAATGAAGGTACATGAAATGCAAAAGCTGATAGGT
#CTAGCATCATATGTTGGATATAAATTTAGATTTGACCTATTATACTACATCAACACACTTGCACAACATATACTATTTCCGTCCAAGCAAGTGTTAGATA
#TGACATATGAATTGATACAGTTCATATGGAATACGAGAGATAAACAACTGATATGGCACAAAAACAAACCTACCGAGCCAGATAATAAATTAGTTGCAAT
#AAGCGATGCCTCGTATGGCAACCAACCGTATTATAAATCACAAATTGGCAACATATATTTACTTAATGGAAAGGTAATTGGAGGAAAGTCCACCAAGGCT
#TCATTAACATGTACTTCAACTACGGAAGCAGAAATACACGCGATAAGTGAATCTGTCCCATTATTAAATAATCTAAGTTACCTGATACAAGAACTTGACA
#AGAAACCAATTACCAAAGGATTACTAACCGACAGTAAATCTACAATCAGTATAATTATATCCAATAATGAAGAGAAATTTAGGAACAGATTTTTTGGTAC
#TAAAGCAATGAGATTGAGAGATGAAGTATCAGGAAATCATCTGCACGTATGCTATATCGAAACCAAAAAGAATATTGCAGACGTAATGACCAAACCTCTT
#CCGATAAAAACATTCAAACTATTAACAAACAAATGGATTCATTAGATCTATTACATTATGGGTGGTATGTTGGAATAAAAATCCACTATCGTCTATCAAC
#TAATAGTTATATTATCAATATATTATCATATACGGTGTTAAGATGATGACATAAGTTATGAGAAGCTGTCATCGAAGTTAGAGGAAGCTGAAACGCAAGG
#ATTGATAATGTAATAGGATCAATGAATATATAAAACGGAATGAGGAATAATCGTAATATTAGTATGTAGAAATATAGATTCCATTTTGAGGATTCCTATA
#TCCTCGAGGAGAACTTCTAGTATATTCTGTATACCTAATATTATAGCCTTTATCAACAATGGAATC
#";

#my $ty1 = "
#TCATGGTAGCGCCTGTGCTTCGGTTACTTCTAAGGAAGTCCACACAAATCAAGATCCGTTAGACGTTTCAGCTTCCAAAACAGAAGAATGTGAGAAGGCT
#TCCACTAAGGCTAACTCTCAACAGACAACAACACCTGCTTCATCAGCTGTTCCAGAGAACCCCCATCATGCCTCTCCTCAACCTGCTTCAGTACCACCTC
#CACAGAATGGGCCGTACCCACAGCAGTGCATGATGACCCAAAACCAAGCCAATCCATCTGGTTGGTCATTTTACGGACACCCATCTATGATTCCGTATAC
#ACCTTATCAAATGTCGCCTATGTACTTTCCACCTGGGCCACAATCACAGTTTCCGCAGTATCCATCATCAGTTGGAACGCCTCTGAGCACTCCATCACCT
#GAGTCAGGTAATACATTTACTGATTCATCCTCAGCGGACTCTGATATGACATCCACTAAAAAATATGTCAGACCACCACCAATGTTAACCTCACCTAATG
#ACTTTCCAAATTGGGTTAAAACATACATCAAATTTTTACAAAACTCGAATCTCGGTGGTATTATTCCGACAGTAAACGGAAAACCCGTACCACCAATGTT
#AACCTCACCTAATGACTTTCCAAATTGGGTTAAAACATACATCAAATTTTTACAAAACTCGAATCTCGGTGGTATTATTCCGACAGTAAACGGAAAACCC
#GTACGTCAGATCACTGATGATGAACTCACCTTCTTGTATAACACTTTTCAAATATTTGCTCCCTCTCAATTCCTACCTACCTGGGTCAAAGACATCCTAT
#CCGTTGATTATACGGATATCATGAAAATTCTTTCCAAAAGTATTGAAAAAATGCAATCTGATACCCAAGAGGCAAACGACATTGTGACCCTGGCAAATTT
#GCAATATAATGGCAGTACACCTGCAGATGCATTTGAAACAAAAGTCACAAACATTATCGACAGACTGAACAATAATGGCATTCATATCAATAACAAGGTC
#GCATGCCAATTAATTATGAGAGGTCTATCTGGCGAATATAAATTTTTACGCTACACACGTCATCGACATCTAAATATGACAGTCGCTGAACTGTTCTTAG
#ATATCCATGCTATTTATGAAGAACAACAGGGATCGAGAAACAGTAAACCTAATTACAGGAGAAATCCGAGTGATGAGAAGAATGATTCTCGCAGCTATAC
#GAATACAACCAAACCCAAAGTTATAGCTCGGAATCCTCAAAAAACAAATAATTCGAAATCGAAAACAGCCAGGGCTCACAATGTATCCACATCTAATAAC
#TCTCCCAGCACGGACAACGATTCCATCAGTAAATCAACTACTGAACCGATTCAATTGAACAATAAGCACGACCTTCATCTTAGGCCAGAAACTTACTGAA
#TCTACAGTAAATCATACTAATCATTCTGATGATGAACTCCCTGGACACCTCCTTCTCGATTCAGGAGCATCACGAACCCTTATAAGATCTGCTCATCACA
#TACACTCAGCATCATCTAATCCTGACATAAACGTAGTTGATGCTCAAAAAAGAAATATACCAATTAACGCTATTGGTGACCTACAATTTCACTTCCAGGA
#CAACACCAAAACATCAATAAAGGTATTGCACACTCCTAACATAGCCTATGACTTACTCAGTTTGAATGAATTGGCTGCAGTAGATATCACAGCATGCTTT
#ACCAAAAACGTCTTAGAACGGTCTGACGGCACTGTACTTGCACCTATCGTAAAATATGGAGACTTTTACTGGGTATCTAAAAAGTACTTGCTTCCATCAA
#ATATCTCCGTACCCACCATCAATAATGTCCATACAAGTGAAAGTACACGCAAATATCCTTATCCTTTCATTCATCGAATGCTTGCGCATGCCAATGCACA
#GACAATTCGATACTCACTTAAAAATAACACCATCACGTATTTTAACGAATCAGATGTCGACTGGTCTAGTGCTATTGACTATCAATGTCCTGATTGTTTA
#ATCGGCAAAAGCACCAAACACAGACATATCAAAGGTTCACGACTAAAATACCAAAATTCATACGAACCCTTTCAATACCTACATACTGACATATTTGGTC
#CAGTTCACAACCTACCAAAAAGTGCACCATCCTATTTCATCTCATTTACTGATGAGACAACAAAATTCCGTTGGGTTTATCCATTACACGACCGTCGCGA
#GGACTCTATCCTCGATGTTTTTACTACGATACTAGCTTTTATTAAGAACCAGTTTCAGGCCAGTGTCTTGGTTATACAAATGGACCGTGGTTCTGAGTAT
#ACTAACAGAACTCTCCATAAATTCCTTGAAAAAAATGGTATAACTCCATGCTATACAACCACAGCGGATTCCCGAGCACATGGAGTCGCTGAACGGCTCA
#ACCGTACCTTATTAGATGACTGCCGTACTCAACTGCAATGTAGTGGTTTACCGAACCATTTATGGTTCTCTGCAATCGAATTTTCTACTATTGTGAGAAA
#TTCACTAGCTTCACCTAAAAGCAAAAAATCTGCAAGACAACATGCTGGCTTGGCAGGACTTGATATCAGTACTTTGTTACCTTTCGGTCAACCTGTTATC
#GTCAATGATCACAACCCTAACTCCAAAATACATCCTCGTGGCATCCCAGGCTACGCTCTACATCCGTCTCGAAACTCTTATGGATATATCATCTATCTTC
#CATCCTTAAAGAAGACAGTAGATACAACTAACTATGTTATTCTTCAGGGCAAGGAATCCAGATTAGATCAATTCAATTACGACGCACTCACTTTCGATGA
#AGACTTAAACCGTTTAACTGCTTCATATCAATCGTTCATTGCGTCAAATGAGATCCAACAATCCGATGATCTTAACATAGAATCTGACCATGACTTCCAA
#TCTGACATCGAACTACATCCTGAGCAACCGAGAAATGTCCTTTCAAAAGCTGTGAGTCCAACCGATTCCACACCTCCGTCAACTCATACTGAAGATTCGA
#AACGTGTTTCTAAAACCAATATTCGCGCACCCAGAGAAGTTGACCCCAACATATCTGAATCTAATATTCTTCCATCAAAGAAGAGATCTAGCACCCCCCA
#AATTTCCAATATCGAGAGTACCGGTTCGGGTGGTATGCATAAATTAAATGTTCCTTTACTTGCTCCCATGTCCCAATCTAACACACATGAGTCGTCGCAC
#GCCAGTAAATCTAAAGATTTCAGACACTCAGACTCGTACAGTGAAAATGAGACTAATCATACAAACGTACCAATATCCAGTACGGGTGGTACCAACAACA
#AAACTGTTCCGCAGATAAGTGACCAAGAGACTGAGAAAAGGATTATACACCGTTCACCTTCAATCGATGCTTCTCCACCGGAAAATAATTCATCGCACAA
#TATTGTTCCTATCAAAACGCCAACTACTGTTTCTGAACAGAATACCGAGGAATCTATCATCGCTGATCTCCCACTCCCTGATCTACCTCCAGAATCTCCT
#ACCGAATTCCCTGACCCATTTAAAGAACTCCCACCGATCAATTCTCGTCAAACTAATTCCAGTTTGGGTGGTATTGGTGACTCTAATGCCTATACTACTA
#TCAACAGTAAGAAAAGATCATTAGAAGATAATGAAACTGAAATTAAGGTATCACGAGACACATGGAATACTAAGAATATGCGTAGTTTAGAACCTCCGAG
#ATCGAAGAAACGAATTCACCTGATTGCAGCTGTAAAAGCAGTAAAATCAATCAAACCAATACGGACAACCTTACGATACGATGAGGCAATCACCTATAAT
#AAAGATATTAAAGAAAAAGAAAAATATATCGAGGCATACCACAAAGAAGTCAATCAACTGTTGAAGATGAAAACTTGGGACACTGACGAATATTATGACA
#GAAAAGAAATAGACCCTAAAAGAGTAATAAACTCAATGTTTATCTTCAACAAGAAACGTGACGGTACTCATAAAGCTAGATTTGTTGCAAGAGGTGATAT
#TCAGCATCCTGACACTTACGACTCAGGCATGCAATCCAATACCGTACATCACTATGCATTAATGACATCCCTGTCACTTGCATTAGACAATAACTACTAT
#ATTACACAATTAGACATATCTTCGGCATATTTGTATGCAGACATCAAAGAAGAATTATACATAAGACCTCCACCACATTTAGGAATGAATGATAAGTTGA
#TACGTTTGAAGAAATCACTTTATGGATTGAAACAAAGTGGAGCGAACTGGTACGAAACTATCAAATCATACCTGATACAACAATGTGGTATGGAAGAAGT
#TCGTGGATGGTCATGCGTATTTAAAAACAGTCAAGTGACAATTTGTTTATTCGTAGATGATATGGTATTGTTTAGCAAAAATCTAAATTCAAACAAAAGA
#ATTATAACAACACTCAAGAAACAATACGATACAAAGATAATAAATCTGGGTGAAAGTGATAACGAAATTCAATATGACATTCTTGGCTTGGAAATCAAAT
#ACCAAAGAGGTAAATACATGAAATTGGGTATGGAAAACTCATTAACTGAAAAAATACCCAAACTAAACGTACCTTTAAACCCAAAAGGAAGGAAACTTAG
#TGCTCCAGGTCAACCAGGTCTATATATAGACCAGCAAGAACTAGAGCTAGAAGAAGATGATTACAAAATGAAGGTACATGAAATGCAAAAGCTGATAGGT
#CTAGCATCATATGTTGGATATAAATTTAGATTTGACCTATTATACTACATCAACACACTTGCACAACATATACTATTTCCGTCCAAGCAAGTGTTAGATA
#TGACATATGAATTGATACAGTTCATATGGAATACGAGAGATAAGCAATTAATATGGCACAAAAACAAACCTACCGAGCCAAATAATAAATTAGTTGTTAT
#AAGCGATGCCTCGTATGGCAACCAACCGTATTATAAATCACAAATTGGCAACATATATTTACTTAATGGAAAGGTAATTGGAGGAAAGTCCACCAAGGCT
#TCATTAACATGTACTTCAACTACGGAAGCAGAAATACACGCGATAAGTGAATCTGTCCCATTATTAAATAATCTAAGTTACCTGATACAAGAACTTGACA
#AGAAACCAATTACCAAAGGATTACTAACCGACAGTAAATCTACAATCAGTATAATTATATCCAATAATGAAGAGAAATTTAGGAACAGATTTTTTGGTAC
#TAAAGCAATGAGATTGAGAGATGAAGTATCAGGAAATCATCTGCACGTATGCTATATCGAAACCAAAAAGAATATTGCAGACGTAATGACCAAACCTCTT
#CCGATAAAAACATTCAAACTATTAACAAACAAATGGATTCATTAGATCTATTACATTATGGGTGGTATGTTGGAATAAAAATCCACTATCGTCTATCAAC
#TAATAGTTATATTATCAATATATTATCATATACGGTGTTAAGATGATGACATAAGTTATGAGAAGCTGTCATCGAAGTTAGAGGAAGCTGAAACGCAAGG
#ATTGATAATGTAATAGGATCAATGAATATATAAAACGGAATGAGGAATAATCGTAATATTAGTATGTAGAAATATAGATTCCATTTTGAGGATTCCTATA
#TCCTCGAGGAGAACTTCTAGTATATTCTGTATACCTAATATTATAGCCTTTATCAACAATGGAATC
#";

my $ty1 = "
TCATGGTAGCGCCTGTGCTTCGGTTACTTCTAAGGAAGTCCACACAAATCAAGATCCGTTAGACGTTTCAGCTTCCAAAACAGAAGAATGTGAGAAGGCT
TCCACTAAGGCTAACTCTCAACAGACAACAACACCTGCTTCATCAGCTGTTCCAGAGAACCCCCATCATGCCTCTCCTCAACCTGCTTCAGTACCACCTC
CACAGAATGGGCCGTACCCACAGCAGTGCATGATGACCCAAAACCAAGCCAATCCATCTGGTTGGTCATTTTACGGACACCCATCTATGATTCCGTATAC
ACCTTATCAAATGTCGCCTATGTACTTTCCACCTGGGCCACAATCACAGTTTCCGCAGTATCCATCATCAGTTGGAACGCCTCTGAGCACTCCATCACCT
GAGTCAGGTAATACATTTACTGATTCATCCTCAGCGGACTCTGATATGACATCCACTAAAAAATATGTCAGACCACCACCAATGTTAACCTCACCTAATG
ACTTTCCAAATTGGGTTAAAACATACATCAAATTTTTACAAAACTCGAATCTCGGTGGTATTATTCCGACAGTAAACGGAAAACCCGTACCACCAATGTT
AACCTCACCTAATGACTTTCCAAATTGGGTTAAAACATACATCAAATTTTTACAAAACTCGAATCTCGGTGGTATTATTCCGACAGTAAACGGAAAACCC
GTACGTCAGATCACTGATGATGAACTCACCTTCTTGTATAACACTTTTCAAATATTTGCTCCCTCTCAATTCCTACCTACCTGGGTCAAAGACATCCTAT
CCGTTGATTATACGGATATCATGAAAATTCTTTCCAAAAGTATTGAAAAAATGCAATCTGATACCCAAGAGGCAAACGACATTGTGACCCTGGCAAATTT
GCAATATAATGGCAGTACACCTGCAGATGCATTTGAAACAAAAGTCACAAACATTATCGACAGACTGAACAATAATGGCATTCATATCAATAACAAGGTC
GCATGCCAATTAATTATGAGAGGTCTATCTGGCGAATATAAATTTTTACGCTACACACGTCATCGACATCTAAATATGACAGTCGCTGAACTGTTCTTAG
ATATCCATGCTATTTATGAAGAACAACAGGGATCGAGAAACAGTAAACCTAATTACAGGAGAAATCCGAGTGATGAGAAGAATGATTCTCGCAGCTATAC
GAATACAACCAAACCCAAAGTTATAGCTCGGAATCCTCAAAAAACAAATAATTCGAAATCGAAAACAGCCAGGGCTCACAATGTATCCACATCTAATAAC
TCTCCCAGCACGGACAACGATTCCATCAGTAAATCAACTACTGAACCGATTCAATTGAACAATAAGCACGACCTTCATCTTAGGCCAGAAACTTACTGAA
TCTACAGTAAATCATACTAATCATTCTGATGATGAACTCCCTGGACACCTCCTTCTCGATTCAGGAGCATCACGAACCCTTATAAGATCTGCTCATCACA
TACACTCAGCATCATCTAATCCTGACATAAACGTAGTTGATGCTCAAAAAAGAAATATACCAATTAACGCTATTGGTGACCTACAATTTCACTTCCAGGA
CAACACCAAAACATCAATAAAGGTATTGCACACTCCTAACATAGCCTATGACTTACTCAGTTTGAATGAATTGGCTGCAGTAGATATCACAGCATGCTTT
ACCAAAAACGTCTTAGAACGGTCTGACGGCACTGTACTTGCACCTATCGTAAAATATGGAGACTTTTACTGGGTATCTAAAAAGTACTTGCTTCCATCAA
ATATCTCCGTACCCACCATCAATAATGTCCATACAAGTGAAAGTACACGCAAATATCCTTATCCTTTCATTCATCGAATGCTTGCGCATGCCAATGCACA
GACAATTCGATACTCACTTAAAAATAACACCATCACGTATTTTAACGAATCAGATGTCGACTGGTCTAGTGCTATTGACTATCAATGTCCTGATTGTTTA
ATCGGCAAAAGCACCAAACACAGACATATCAAAGGTTCACGACTAAAATACCAAAATTCATACGAACCCTTTCAATACCTACATACTGACATATTTGGTC
CAGTTCACAACCTACCAAAAAGTGCACCATCCTATTTCATCTCATTTACTGATGAGACAACAAAATTCCGTTGGGTTTATCCATTACACGACCGTCGCGA
GGACTCTATCCTCGATGTTTTTACTACGATACTAGCTTTTATTAAGAACCAGTTTCAGGCCAGTGTCTTGGTTATACAAATGGACCGTGGTTCTGAGTAT
ACTAACAGAACTCTCCATAAATTCCTTGAAAAAAATGGTATAACTCCATGCTATACAACCACAGCGGATTCCCGAGCACATGGAGTCGCTGAACGGCTCA
ACCGTACCTTATTAGATGACTGCCGTACTCAACTGCAATGTAGTGGTTTACCGAACCATTTATGGTTCTCTGCAATCGAATTTTCTACTATTGTGAGAAA
TTCACTAGCTTCACCTAAAAGCAAAAAATCTGCAAGACAACATGCTGGCTTGGCAGGACTTGATATCAGTACTTTGTTACCTTTCGGTCAACCTGTTATC
GTCAATGATCACAACCCTAACTCCAAAATACATCCTCGTGGCATCCCAGGCTACGCTCTACATCCGTCTCGAAACTCTTATGGATATATCATCTATCTTC
CATCCTTAAAGAAGACAGTAGATACAACTAACTATGTTATTCTTCAGGGCAAGGAATCCAGATTAGATCAATTCAANTACGACGCACTCACTTTCGATGA
AGACTTAAACCGTTTAACTGCTTCATATCAATCGNTCATTGCGTCAAATGAGATCCAACAATCCGATGATCTTAACATAGAATCTGACCATGACTTCCAA
TCTGACATCGAACTACATCCTGAGCAACCGAGAAATGTCCTTTCAAAAGCTGTGAGTCCAACCGATTCCACACCTCCGTCAACTCATACTGAAGATTCGA
AACGTGTTTCTAAAACCAATATTCGCGCACCCAGAGAAGTTGACCCCAACATATCTGAATCTAATATTCTTCCATCAAAGAAGAGATCTAGCACCCCCCA
AATTTCCAATATCGAGAGTACCGGTTCGGGTGGTATGCATAAATTAAATGTTCCTTTACTTGCTCCCATGTCCCAATCTAACACACATGAGTCGTCGCAC
GCCAGTAAATCTAAAGATTTCAGACACTCAGACTCGTACAGTGAAAATGAGACTAATCATACAAACGTACCAATATCCAGTACGGGTGGTACCAACAACA
AAACTGTTCCGCAGATAAGTGACCAAGAGACTGAGAAAAGGATTATACACCGTTCACCTTCAATCGATGCTTCTCCACCGGAAAATAATTCATCGCACAA
TATTGTTCCTATCAAAACGCCAACTACTGTTTCTGAACAGAATACCGAGGAATCTATCATCGCTGATCTCCCACTCCCTGATCTACCTCCAGAATCTCCT
ACCGAATTCCCTGACCCATTTAAAGAACTCCCACCGATCAATTCTCGTCAAACTAATTCCAGTTTGGGTGGTATTGGTGACTCTAATGCCTATACTACTA
TCAACAGTAAGAAAAGATCATTAGAAGATAATGAAACTGAAATTAAGGTATCACGAGACACATGGAATACTAAGAATATGCGTAGTTTAGAACCTCCGAG
ATCGAAGAAACGAATTCACCTGATTGCAGCTGTAAAAGCAGTAAAATCAATCAAACCAATACGGACAACCTTACGATACGATGAGGCAATCACCTATAAT
AAAGATATTAAAGAAAAAGAAAAATATATCGAGGCATACCACAAAGAAGTCAATCAACTGTTGAAGATGAAAACTTGGGACACTGACGAATATTATGACA
GAAAAGAAATAGACCCTAAAAGAGTAATAAACTCAATGTTTATCTTCAACAAGAAACGTGACGGTACTCATAAAGCTAGATTTGTTGCAAGAGGTGATAT
TCAGCATCCTGACACTTACGACTCAGGCATGCAATCCAATACCGTACATCACTATGCATTAATGACATCCCTGTCACTTGCATTAGACAATAACTACTAT
ATTACACAATTAGACATATCTTCGGCATATTTGTATGCAGACATCAAAGAAGAATTATACATAAGACCTCCACCACATTTAGGAATGAATGATAAGTTGA
TACGTTTGAAGAAATCACTTTATGGATTGAAACAAAGTGGAGCGAACTGGTACGAAACTATCAAATCATACCTGATACAACAATGTGGTATGGAAGAAGT
TCGTGGATGGTCATGCGTATTTAAAAACAGTCAAGTGACAATTTGTTTATTCGTAGATGATATGGTATTGTTTAGCAAAAATCTAAATTCAAACAAAAGA
ATTATAACAACACTCAAGAAACAATACGATACAAAGATAATAAATCTGGGTGAAAGTGATAACGAAATTCAATATGACATTCTTGGCTTGGAAATCAAAT
ACCAAAGAGGTAAATACATGAAATTGGGTATGGAAAACTCATTAACTGAAAAAATACCCAAACTAAACGTACCTTTAAACCCAAAAGGAAGGAAACTTAG
TGCTCCAGGTCAACCAGGTCTATATATAGACCAGCAAGAACTAGAGCTAGAAGAAGATGATTACAAAATGAAGGTACATGAAATGCAAAAGCTGATAGGT
CTAGCATCATATGTTGGATATAAATTTAGATTTGACCTATTATACTACATCAACACACTTGCACAACATATACTATTTCCGTCCAAGCAAGTGTTAGATA
TGACATATGAATTGATACAGTTCATATGGAATACGAGAGATAAGCAATTAATATGGCACAAAAGCAAACCTACCGAGCCAACTAATAAATTAGTTGTTAT
AAGCGATGCCTCGTATGGCAACCAACCGTATTATAAATCACAAATTGGCAACATATATTTACTTAATGGAAAGGTAATTGGAGGAAAGTCCACCAAGGCT
TCATTAACATGTACTTCAACTACGGAAGCAGAAATACACGCGATAAGTGAATCTGTCCCATTATTAAATAATCTAAGTTACCTGATACAAGAACTTGACA
AGAAACCAATTACCAAAGGATTACTAACCGACAGTAAATCTACAATCAGTATAATTATATCCAATAATGAAGAGAAATTTAGGAACAGATTTTTTGGTAC
TAAAGCAATGAGATTGAGAGATGAAGTATCAGGAAATCATCTGCACGTATGCTATATCGAAACCAAAAAGAATATTGCAGACGTAATGACCAAACCTCTT
CCGATAAAAACATTCAAACTATTAACAAACAAATGGATTCATTAGATCTATTACATTATGGGTGGTATGTTGGAATAAAAATCCACTATCGTCTATCAAC
TAATAGTTATATTATCAATATATTATCATATACGGTGTTAAGATGATGACATAAGTTATGAGAAGCTGTCATCGAAGTTAGAGGAAGCTGAAACGCAAGG
ATTGATAATGTAATAGGATCAATGAATATATAAAACGGAATGAGGAATAATCGTAATATTAGTATGTAGAAATATAGATTCCATTTTGAGGATTCCTATA
TCCTCGAGGAGAACTTCTAGTATATTCTGTATACCTAATATTATAGCCTTTATCAACAATGGAATC
";


$ty1 =~ s/\s//g;

sub mapTy1{
    #runSQL("SELECT POSITION1, LENGTH1, STRAND1, DISCREPANCIES1 || 'x' FROM FRAGS_CHR2TY", \my($pos, $length, $strand, $discs));
    runSQL("SELECT POSITION1, LENGTH1, STRAND1, DISCREPANCIES1 || 'x' FROM FRAGS_CHR2TYVAL", \my($pos, $length, $strand, $discs));
    my %bases;    
    while(fetchRow()){
        my %discs;
        $discs =~ m/(.*)x$/; #strip the 'x' appended to force Perl to use $discreps as string
        while ($1){
            #$1 = discreps remaining; $2 = relPos, $3 = discType, $4 = extra
            $1 =~ m/(.*)(..)(.)(.)$/ or $1 =~ m/(.*)(.)(.)(.)$/;                       
            $3 and $discs{$2} = $3;
        }    
        foreach my $absPos($pos..($pos + $length - 1)){
            my $relPos = $absPos - $pos + 1;        
            my $value = 0;
            $discs{$relPos} and $value = $discs{$relPos};
            $bases{$absPos}{$value}++;
        }
    }
    my @pos = sort {$a <=> $b} keys %bases;
    my $minPos = shift @pos;
    my $maxPos = pop @pos;
    my $sequence;
    my %sequence;
    foreach my $absPos($minPos..$maxPos){
        my $before = $absPos - 1;
        $ty1 =~ m/^.{$before}(.)/ or die "not yet\n";        
        my $refBase = $1;
        my $consensus;
        if($bases{$absPos}){
            my %counts;
            foreach my $value(0..7){ 
                if($bases{$absPos}{$value}){
                    $counts{$bases{$absPos}{$value}} = $value
                } else {
                    $bases{$absPos}{$value} = " ";
                }
            }
            my @counts = sort {$b <=> $a} keys %counts;
            my $maxCount = $counts[0];  
            $consensus = $counts{$maxCount};  
        } else {
            $consensus = "N";
            #$consensus = $refBase;
            foreach my $value(0..7){ $bases{$absPos}{$value} = " " }
        }
        $consensus or $consensus = $refBase;
        $sequence .= $consensus;
        foreach my $value(0..7){ 
            unless($bases{$absPos}{$value} eq ' '){$bases{$absPos}{$value} > 9 and $bases{$absPos}{$value} = '*'}
            $sequence{$value} .= $bases{$absPos}{$value} 
        }
    }
    
    print length $sequence, "\n";
    foreach my $value(0..7){  print length $sequence{$value}, "\n" }
    
    $sequence =~ s/0/-/g;
    $sequence =~ s/1/A/g;
    $sequence =~ s/2/C/g;
    $sequence =~ s/3/G/g;
    $sequence =~ s/4/T/g;
    $sequence =~ s/5/N/g;
    $sequence =~ s/6/M/g;
    $sequence =~ s/7/E/g;
    print "\n\n$minPos\n$sequence\n$maxPos\n\n";
    
    open my $outH, ">", "chr2Ty1.fa";
    print $outH ">chr2Ty1\n";
    my $bpPerLine = 100;
    while($sequence and $sequence =~ m/(.{$bpPerLine})(.*)/ ){
        print $outH "$1\n";
        $sequence = $2;        
#        foreach my $value(0..7){ 
#            $sequence{$value} =~ m/(.{$bpPerLine})(.*)/;
#            print $outH "$1\n";
#            $sequence{$value} = $2;   
#        }
#        print $outH "\n";
    }
    $sequence and print $outH "$sequence\n";
    #foreach my $value(0..7){ $sequence{$value} and print $outH "$sequence{$value}\n" }
    close $outH;
    
}


1;



